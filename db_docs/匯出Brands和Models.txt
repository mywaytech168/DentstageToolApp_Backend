CREATE TABLE brands (
    BrandUID VARCHAR(100) NOT NULL PRIMARY KEY,
    BrandName VARCHAR(100) NOT NULL
) ENGINE=InnoDB;

CREATE TABLE models (
    ModelUID VARCHAR(100) NOT NULL PRIMARY KEY,
    BrandUID VARCHAR(100),
    ModelName VARCHAR(100) NOT NULL,
    FOREIGN KEY (BrandUID) REFERENCES brands(BrandUID)
) ENGINE=InnoDB;

INSERT INTO brands (BrandUID, BrandName)
SELECT 
    CONCAT('B_', UPPER(UUID())) AS BrandUID,
    q.Brand
FROM quatations q
WHERE q.Brand IS NOT NULL AND q.Brand <> ''
GROUP BY q.Brand;

INSERT INTO models (ModelUID, BrandUID, ModelName)
SELECT 
    CONCAT('M_', UPPER(UUID())) AS ModelUID,
    b.BrandUID,
    q.Model
FROM quatations q
JOIN brands b ON q.Brand = b.BrandName
WHERE q.Model IS NOT NULL AND q.Model <> ''
GROUP BY b.BrandUID, q.Model;
