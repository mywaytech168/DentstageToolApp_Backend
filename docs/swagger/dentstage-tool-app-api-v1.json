                                            "fixTimeMin": {
                                                "type": "integer",
                                                "description": "\u820a\u7cfb\u7d71\u4fdd\u7559\u6b04\u4f4d\uff1a\u4f30\u8a08\u5de5\u6642\uff08\u5206\u9418\uff09\u3002"
                                            },
                                            "fixExpectDay": {
                                                "type": "integer",
                                                "description": "\u820a\u7cfb\u7d71\u4fdd\u7559\u6b04\u4f4d\uff1a\u9810\u4f30\u5b8c\u6210\u5929\u6578\u3002"
                                            },
                                            "fixExpectHour": {
                                                "type": "integer",
                                                "description": "\u820a\u7cfb\u7d71\u4fdd\u7559\u6b04\u4f4d\uff1a\u9810\u4f30\u5b8c\u6210\u5c0f\u6642\u3002"
                                            },
                                            "suggestedPaintReason": {
                                                "type": "string",
                                                "description": "\u5efa\u8b70\u6539\u63a1\u9211\u70e4\u7684\u539f\u56e0\u3002"
                                            },
                                            "unrepairableReason": {
                                                "type": "string",
                                                "description": "\u7121\u6cd5\u4fee\u5fa9\u539f\u56e0\u3002"
                                            },
                                            "categoryAdjustments": {
                                                "type": "object",
                                                "description": "\u4f9d\u51f9\u75d5\u3001\u7f8e\u5bb9\u3001\u677f\u70e4\u3001\u5176\u4ed6\u62c6\u5206\u7684\u8cbb\u7528\u8207\u6298\u6263\u8a2d\u5b9a\u3002",
                                                "properties": {
                                                    "dent": {
                                                        "$ref": "#/components/schemas/QuotationMaintenanceCategoryAdjustment"
                                                    },
                                                    "beauty": {
                                                        "$ref": "#/components/schemas/QuotationMaintenanceCategoryAdjustment"
                                                    },
                                                    "paint": {
                                                        "$ref": "#/components/schemas/QuotationMaintenanceCategoryAdjustment"
                                                    },
                                                    "other": {
                                                        "$ref": "#/components/schemas/QuotationMaintenanceCategoryAdjustment"
                                                    }
                                                }
                                            },
                                            "remark": {
                                                "type": "string",
                                                "description": "\u7dad\u4fee\u8a2d\u5b9a\u5099\u8a3b\u3002"
                                            }
                                        }
                                    }
                                }
                            },
                            "example": {
                                "store": {
                                    "estimationTechnicianUid": "U_054C053D-FBA6-D843-9BDA-8C68E5027895",
                                    "creatorTechnicianUid": "U_054C053D-FBA6-D843-9BDA-8C68E5027895",
                                    "bookMethod": "LINE \u9810\u7d04"
                                },
                                "car": {
                                    "carUid": "Ca_00D20FB3-E0D1-440A-93C4-4F62AB511C2D",
                                    "brandUid": "B_C7CAB67F-9F5A-11F0-A812-000C2990DEAF",
                                    "modelUid": "M_E706D04B-9F5A-11F0-A812-000C2990DEAF",
                                    "mileage": 18500
                                },
                                "customer": {
                                    "customerUid": "Cu_1B65002E-EEC5-42FA-BBBB-6F5E4708610A"
                                },
                                "photos": {
                                    "dent": [
                                        {
                                            "photo": "Ph_759F19C7-5D62-4DB2-8021-2371C3136F7B",
                                            "position": "\u4fdd\u687f",
                                            "dentStatus": "\u5927\u9762\u7a4d",
                                            "description": "\u9700\u677f\u91d1\u642d\u914d\u70e4\u6f06",
                                            "estimatedAmount": 4500
                                        }
                                    ],
                                    "beauty": [],
                                    "paint": [
                                        {
                                            "photo": "Ph_1F8AC157-5AC2-4E9C-9E0C-A5E8B4C8F3B0",
                                            "position": "\u53f3\u5f8c\u8449\u5b50\u677f",
                                            "dentStatus": "\u522e\u75d5",
                                            "description": "\u522e\u50b7\u9700\u88dc\u571f\u70e4\u6f06",
                                            "estimatedAmount": 3200
                                        }
                                    ],
                                    "other": []
                                },
                                "carBodyConfirmation": {
                                    "signaturePhotoUid": "Ph_D4FB9159-CD9E-473A-A3D9-0A8FDD0B76F8",
                                    "damageMarkers": [
                                        {
                                            "start": { "x": 0.42, "y": 0.63 },
                                            "end": { "x": 0.58, "y": 0.68 },
                                            "hasDent": true,
                                            "hasScratch": false,
                                            "hasPaintPeel": false,
                                            "remark": "\u4e3b\u8981\u51f9\u75d5"
                                        }
                                    ]
                                },
                                "maintenance": {
                                    "reserveCar": false,
                                    "applyCoating": true,
                                    "applyWrapping": true,
                                    "hasRepainted": true,
                                    "needToolEvaluation": false,
                                    "otherFee": 1229,
                                    "roundingDiscount": 0,
                                    "percentageDiscount": 10,
                                    "discountReason": null,
                                    "estimatedRepairDays": 1,
                                    "estimatedRepairHours": 3,
                                    "estimatedRestorationPercentage": 91,
                                    "suggestedPaintReason": null,
                                    "unrepairableReason": null,
                                    "categoryAdjustments": {
                                        "dent": {
                                            "otherFee": 300,
                                            "percentageDiscount": 5,
                                            "discountReason": "\u51f9\u75d5\u7dad\u4fee\u56de\u994b\u65b9\u6848"
                                        },
                                        "beauty": {},
                                        "paint": {
                                            "otherFee": 500,
                                            "percentageDiscount": 8,
                                            "discountReason": "\u677f\u70e4\u5468\u5e74\u6298\u6263"
                                        },
                                        "other": {
                                            "otherFee": 800,
                                            "percentageDiscount": 10,
                                            "discountReason": "\u5176\u4ed6\u670d\u52d9\u8d08\u9001\u65b9\u6848"
                                        }
                                    },
                                    "remark": "\u8acb\u65bc\u4fee\u5fa9\u5f8c\u901a\u77e5\u5ba2\u6236\u53d6\u8eca"
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "\u5efa\u7acb\u6210\u529f\uff0c\u56de\u50b3\u4f30\u50f9\u55ae\u7de8\u865f\u3002"
                    },
                    "400": {
                        "description": "\u8acb\u6c42\u53c3\u6578\u6709\u8aa4\u6216\u7f3a\u5c11\u5fc5\u8981\u6b04\u4f4d\u3002"
                    }
                }
            }
        }
    },
    "/api/maintenance-orders/confirm": {
        "post": {
            "tags": [
                "MaintenanceOrders"
            ],
            "summary": "（已移除）確認維修開始（移至估價端）",
            "description": "此端點已移除，請使用 POST /api/quotations/confirm-maintenance 並傳入 quotationNo 以由估價單建立維修單並進入維修中（220）。",
            "deprecated": true,
            "requestBody": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "object",
                            "properties": {
                                "orderNo": { "type": "string" }
                            }
                        },
                        "example": { "orderNo": "O25100001" }
                    }
                }
            },
            "responses": {
                "410": {
                    "description": "已移除：請改用 POST /api/quotations/confirm-maintenance"
                }
            }
        }
    },
    "/api/quotations/maintenance": {
        "post": {
            "tags": [
                "Quotations"
            ],
            "summary": "將估價單標記為待維修（191）",
            "description": "此端點僅將指定的估價單標記為待維修（狀態 191），並不會立即建立維修單。若要由估價端建立維修單或確認既有工單請呼叫 POST /api/quotations/confirm-maintenance。",
            "requestBody": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "object",
                            "properties": {
                                "quotationNo": { "type": "string" }
                            }
                        },
                        "example": { "quotationNo": "Q25100001" }
                    }
                }
            },
            "responses": {
                "200": {
                    "description": "估價單已被標記為待維修（191）。",
                    "content": {
                        "application/json": {
                            "schema": { "type": "object", "properties": { "quotationNo": { "type": "string" }, "status": { "type": "string" } } },
                            "examples": {
                                "default": {
                                    "summary": "標記成功",
                                    "value": { "quotationNo": "Q25100001", "status": "191" }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "/api/quotations/confirm-maintenance": {
        "post": {
            "tags": [
                "Quotations"
            ],
            "summary": "估價端確認維修（由估價單建立維修單並進入維修中）",
            "description": "以 quotationNo 建立維修單並將維修單狀態更新為 220（維修中）。",
            "requestBody": {
                "required": true,
                "content": {
                    "application/json": {
                        "schema": {
                            "type": "object",
                            "properties": {
                                "quotationNo": { "type": "string" }
                            }
                        },
                        "example": { "quotationNo": "Q25100001" }
                    }
                }
            },
            "responses": {
                "200": {
                    "description": "成功建立維修單並回傳維修單資訊",
                    "content": {
                        "application/json": {
                            "schema": { "$ref": "#/components/schemas/QuotationMaintenanceConversionResponse" },
                            "examples": {
                                "default": {
                                    "summary": "建立並回傳新工單",
                                    "value": {
                                        "quotationUid": "Q_3A5F...",
                                        "quotationNo": "Q25100001",
                                        "status": "220",
                                        "statusChangedAt": "2025-11-07T08:46:00Z",
                                        "reservationDate": null,
                                        "orderUid": "O_7B2D...",
                                        "orderNo": "O25100001",
                                        "orderCreatedAt": "2025-11-07T08:46:00Z"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "HealthCheckResponse": {
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string",
                        "description": "\u7cfb\u7d71\u6574\u9ad4\u72c0\u614b\u63cf\u8ff0\u3002"
                    },
                    "message": {
                        "type": "string",
                        "description": "\u5065\u5eb7\u6aa2\u67e5\u7684\u88dc\u5145\u8aaa\u660e\u6216\u63d0\u793a\u8a0a\u606f\u3002"
                    },
                    "timestamp": {
                        "type": "string",
                        "format": "date-time",
                        "description": "\u7522\u751f\u5065\u5eb7\u6aa2\u67e5\u7d50\u679c\u7684\u6642\u9593 (UTC)\u3002"
                    }
                },
                "required": [
                    "status",
                    "message",
                    "timestamp"
                ]
            },
            "QuotationPhotoItem": {
                "type": "object",
                "description": "\u4f30\u50f9\u55ae\u5efa\u7acb\u6216\u7de8\u8f2f\u6642\u63d0\u4ea4\u7684\u50b7\u75d5\u9805\u76ee\uff0c\u5167\u542b\u55ae\u4e00\u7167\u7247\u8207\u4f30\u50f9\u8cc7\u8a0a\u3002",
                "properties": {
                    "photo": {
                        "type": "string",
                        "description": "\u7d81\u5b9a\u50b7\u75d5\u7684 PhotoUID \u5b57\u4e32\uff0c\u50c5\u9700\u63d0\u4f9b\u4e00\u500b\u8b58\u5225\u78bc\u3002"
                    },
                    "position": {
                        "type": "string",
                        "description": "\u640d\u50b7\u4f4d\u7f6e\u6216\u90e8\u4f4d\u63cf\u8ff0\u3002"
                    },
                    "dentStatus": {
                        "type": "string",
                        "description": "\u640d\u50b7\u72c0\u614b\u63cf\u8ff0\uff0c\u4f8b\u5982\u5927\u9762\u7a4d\u6216\u522e\u75d5\u3002"
                    },
                    "description": {
                        "type": "string",
                        "description": "\u4f30\u50f9\u5099\u8a3b\u3002"
                    },
                    "estimatedAmount": {
                        "type": "number",
                        "description": "\u9810\u4f30\u91d1\u984d (\u5143)\u3002"
                    }
                },
                "required": [
                    "photo"
                ]
            },
            "QuotationMaintenanceCategoryAdjustment": {
                "type": "object",
                "description": "\u7dad\u4fee\u6298\u6263\u5206\u985e\u8a2d\u5b9a\uff0c\u6db5\u84cb\u984d\u5916\u8cbb\u7528\u8207\u767e\u5206\u6bd4\u6298\u6263\u3002",
                "properties": {
                    "otherFee": {
                        "type": "number",
                        "format": "double",
                        "description": "\u8a72\u5206\u985e\u7684\u984d\u5916\u8cbb\u7528\u3002"
                    },
                    "percentageDiscount": {
                        "type": "number",
                        "format": "double",
                        "description": "\u8a72\u5206\u985e\u7684\u6298\u6263\u767e\u5206\u6bd4\u3002"
                    },
                    "discountReason": {
                        "type": "string",
                        "description": "\u8a72\u5206\u985e\u6298\u6263\u539f\u56e0\u8aaa\u660e\u3002"
                    }
                }
            },
            "QuotationListQuery": {
                "type": "object",
                "description": "查詢參數物件（可用於 POST /api/quotations/old），EndDate 會被系統強制設為 cutoff（兩年前）。",
                "properties": {
                    "fixType": { "type": "string" },
                    "status": { "type": "array", "items": { "type": "integer" } },
                    "startDate": { "type": "string", "format": "date-time" },
                    "endDate": { "type": "string", "format": "date-time" },
                    "page": { "type": "integer", "default": 1 },
                    "pageSize": { "type": "integer", "default": 20 }
                }
            },
            "QuotationListResponse": {
                "type": "object",
                "description": "分頁的估價單列表回應（簡化版）。",
                "properties": {
                    "pagination": { "type": "object", "properties": { "page": { "type": "integer" }, "pageSize": { "type": "integer" }, "totalCount": { "type": "integer" }, "totalPages": { "type": "integer" } } },
                    "items": { "type": "array", "items": { "type": "object", "properties": { "quotationUid": { "type": "string" }, "quotationNo": { "type": "string" }, "status": { "type": "string" }, "createdAt": { "type": "string", "format": "date-time" } } } }
                }
            },
            "MaintenanceOrderListQuery": {
                "type": "object",
                "description": "查詢參數物件（可用於 POST /api/maintenance-orders/old），EndDate 為系統強制 cutoff（兩年前）。",
                "properties": {
                    "fixType": { "type": "string" },
                    "status": { "type": "array", "items": { "type": "integer" } },
                    "startDate": { "type": "string", "format": "date-time" },
                    "endDate": { "type": "string", "format": "date-time" },
                    "page": { "type": "integer", "default": 1 },
                    "pageSize": { "type": "integer", "default": 20 }
                }
            },
            "MaintenanceOrderListResponse": {
                "type": "object",
                "description": "分頁的維修單列表回應（簡化版）。",
                "properties": {
                    "pagination": { "type": "object", "properties": { "page": { "type": "integer" }, "pageSize": { "type": "integer" }, "totalCount": { "type": "integer" }, "totalPages": { "type": "integer" } } },
                    "items": { "type": "array", "items": { "type": "object", "properties": { "orderUid": { "type": "string" }, "orderNo": { "type": "string" }, "status": { "type": "string" }, "createdAt": { "type": "string", "format": "date-time" } } } }
                }
            },
            "PurchaseOrderDto_Simple": {
                "type": "object",
                "description": "採購單簡化 DTO，包含建立時間 CreatedAt（UTC）。",
                "properties": {
                    "purchaseUid": { "type": "string" },
                    "purchaseNo": { "type": "string" },
                    "supplierName": { "type": "string" },
                    "purchaseDate": { "type": "string", "format": "date" },
                    "createdAt": { "type": "string", "format": "date-time", "description": "建立時間（UTC，ISO8601）" },
                    "totalAmount": { "type": "number", "format": "double" }
                }
            },
            "PurchaseOrderListResponse": {
                "type": "object",
                "description": "分頁的採購單列表回應（簡化版），items 內包含 `createdAt` 欄位。",
                "properties": {
                    "pagination": { "type": "object", "properties": { "page": { "type": "integer" }, "pageSize": { "type": "integer" }, "totalCount": { "type": "integer" }, "totalPages": { "type": "integer" } } },
                    "items": { "type": "array", "items": { "$ref": "#/components/schemas/PurchaseOrderDto_Simple" } }
                }
            }
        }
    }
}
